{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ category.name }} - BidBar</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body style="margin: 0 !important; padding: 0 !important;">
    <!-- 배경 레이어 -->
    <div class="background-with-gradient"></div>
    
    <!-- 사이드 메뉴 버튼 -->
    <button class="menu-toggle" id="menuToggle">☰</button>

    <!-- 사이드 메뉴 -->
    <div class="side-menu" id="sideMenu">
        <div class="side-menu-header">
            <h3>메뉴</h3>
            <button class="close-menu" id="closeMenu">×</button>
        </div>
        <div class="side-menu-content">
            <ul class="category-nav">
                <li><a href="{% url 'menu:menu_main' %}">홈</a></li>
                {% for cat in all_categories %}
                    {% if not cat.parent %}
                        <li class="top-category">
                            <div class="category-header" onclick="toggleCategory({{ cat.id }})">
                                <span class="toggle-icon" id="icon-{{ cat.id }}">▶</span>
                                <a href="{% url 'menu:menu_list' cat.id %}" {% if cat.id == category.id %}class="current"{% endif %}>{{ cat.name }}</a>
                            </div>
                            <ul class="sub-categories" id="sub-{{ cat.id }}" style="display: none;">
                                {% for sub_cat in cat.sub_categories.all %}
                                    <li><a href="{% url 'menu:menu_list' sub_cat.id %}" {% if sub_cat.id == category.id %}class="current"{% endif %}>{{ sub_cat.name }}</a></li>
                                {% endfor %}
                            </ul>
                        </li>
                    {% endif %}
                {% endfor %}
            </ul>
        </div>
    </div>

    <!-- 사이드 메뉴 오버레이 -->
    <div class="menu-overlay" id="menuOverlay"></div>
    
    <!-- 콘텐츠 레이어 -->
    <div class="menu-container">
        <main class="main" style="padding: 0 !important; margin: 0 !important;">
            <div class="container" style="padding: 0 !important; margin: 0 !important; max-width: none !important;">
                <div class="category-section" style="margin: 0 !important; padding: 0 !important;">
                    <div class="category-grid">
                        {% for sub_category in categories %}
                        <a href="{% url 'menu:menu_list' sub_category.id %}" class="category-card">
                            <h3>{{ sub_category.name }}</h3>
                        </a>
                        {% empty %}
                        <div class="no-categories">
                            등록된 하위 카테고리가 없습니다.
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // 사이드 메뉴 기능
        const menuToggle = document.getElementById('menuToggle');
        const sideMenu = document.getElementById('sideMenu');
        const menuOverlay = document.getElementById('menuOverlay');
        const closeMenu = document.getElementById('closeMenu');

        function openMenu() {
            sideMenu.classList.add('active');
            menuOverlay.classList.add('active');
        }

        function closeMenuFunc() {
            sideMenu.classList.remove('active');
            menuOverlay.classList.remove('active');
        }

        function toggleCategory(categoryId) {
            const subCategories = document.getElementById('sub-' + categoryId);
            const icon = document.getElementById('icon-' + categoryId);
            
            if (subCategories.style.display === 'none') {
                subCategories.style.display = 'block';
                icon.textContent = '▼';
            } else {
                subCategories.style.display = 'none';
                icon.textContent = '▶';
            }
        }

        menuToggle.addEventListener('click', openMenu);
        closeMenu.addEventListener('click', closeMenuFunc);
        menuOverlay.addEventListener('click', closeMenuFunc);
    </script>
</body>
</html>
